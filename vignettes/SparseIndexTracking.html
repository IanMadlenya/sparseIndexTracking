<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Konstantinos Benidis and Daniel P. Palomar" />

<meta name="date" content="2018-04-25" />

<title>Design of Portfolio of Stocks to Track an Index</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Design of Portfolio of Stocks to Track an Index</h1>
<h4 class="author"><em>Konstantinos Benidis and Daniel P. Palomar</em></h4>
<h4 class="date"><em>2018-04-25</em></h4>


<div id="TOC">
<ul>
<li><a href="#comparison-with-other-packages"><span class="toc-section-number">1</span> Comparison with other packages</a></li>
<li><a href="#usage-of-the-package"><span class="toc-section-number">2</span> Usage of the package</a></li>
<li><a href="#explanation-of-the-algorithms"><span class="toc-section-number">3</span> Explanation of the algorithms</a><ul>
<li><a href="#spindextrack-sparse-portfolio-construction"><span class="toc-section-number">3.1</span> <code>spIndexTrack()</code>: Sparse portfolio construction</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<hr />
<p>This vignette illustrates the design of sparse portfolios that aim to track a financila index with the package <code>sparseIndexTracking</code> (with a comparison with other packages) and gives a description of the algorithms used.</p>
<div id="comparison-with-other-packages" class="section level1">
<h1><span class="header-section-number">1</span> Comparison with other packages</h1>
</div>
<div id="usage-of-the-package" class="section level1">
<h1><span class="header-section-number">2</span> Usage of the package</h1>
</div>
<div id="explanation-of-the-algorithms" class="section level1">
<h1><span class="header-section-number">3</span> Explanation of the algorithms</h1>
<div id="spindextrack-sparse-portfolio-construction" class="section level2">
<h2><span class="header-section-number">3.1</span> <code>spIndexTrack()</code>: Sparse portfolio construction</h2>
<p>Assume that an index is composed of <span class="math inline">\(N\)</span> assets. We denote by <span class="math inline">\(\mathbf{r}^b=[r_1^b,\dots,r_T^b]^\top\in\mathbb{R}^T\)</span> and <span class="math inline">\(\mathbf{X}=[\mathbf{r}_1,\dots,\mathbf{r}_T]^\top\in\mathbb{R}^{T\times N}\)</span> the (arithmetic) net returns of the index and the <span class="math inline">\(N\)</span> assets in the past <span class="math inline">\(T\)</span> days, respectively, with <span class="math inline">\(\mathbf{r}_t\in\mathbb{R}^N\)</span> denoting the net returns of the <span class="math inline">\(N\)</span> assets at the <span class="math inline">\(t\)</span>-th day.</p>
<p>The goal of <code>spIndexTrack()</code> is the design of a (sparse) portfolio <span class="math inline">\(\mathbf{w}\in\mathbb{R}_+^N\)</span>, with <span class="math inline">\(\mathbf{w}^\top\mathbf{1} = 1\)</span>, that tracks closely the index, i.e., <span class="math inline">\(\mathbf{X}\mathbf{w} \approx \mathbf{r}^b\)</span>, based on <span class="citation">[1]</span>. The underlying optimization problem that is solved is <span class="math display">\[
\begin{array}{ll}
\underset{\mathbf{w}}{\text{minimize}} &amp; \text{TE}(\mathbf{w}) + \lambda\|\mathbf{w}\|_0\\
\textsf{subject to}
 &amp; \mathbf{w}^\top\mathbf{1}=1\\
 &amp; \mathbf{0}\leq\mathbf{w}\leq u\mathbf{1},
\end{array} \qquad (1)
\]</span> where <span class="math inline">\(\text{TE}(\mathbf{w})\)</span> is a general tracking error (we will see specific tracking errors shortly), <span class="math inline">\(\lambda\)</span> is a regularization parameter that controls the sparsity of the portfolio, and <span class="math inline">\(u\)</span> is an upper bound on the weights of the portfolio.</p>
<p>The <span class="math inline">\(\ell_0\)</span>-“norm” is approximated by the continuous and differentiable function (for <span class="math inline">\(\mathbf{w} \geq \mathbf{0}\)</span>) <span class="math display">\[
\rho_{p,u}(w) = \frac{\log(1 + w/p)}{\log(1 + u/p)},
\]</span> where <span class="math inline">\(p&gt;0\)</span> is a parameter that controls the approximation. This leads to the following approximate problem: <span class="math display">\[
\begin{array}{ll}
\underset{\mathbf{w}}{\text{minimize}} &amp; \text{TE}(\mathbf{w}) + \lambda\mathbf{1}^\top\boldsymbol{\rho}_{p,u}(\mathbf{w})\\
\textsf{subject to}
 &amp; \mathbf{w}^\top\mathbf{1}=1\\
 &amp; \mathbf{0}\leq\mathbf{w}\leq u\mathbf{1},
\end{array} \qquad (2)
\]</span> where <span class="math inline">\(\boldsymbol{\rho}_{p,u}(\mathbf{w})=[\mathbf{\rho}_{p,u}(w_1),\dots,\rho_{p,u}(w_N)]^\top\)</span>.</p>
<p>There are four available tracking errors <span class="math inline">\(\text{TE}(\mathbf{w}\)</span>) in <code>spIndexTrack()</code>:</p>
<ul>
<li>Empirical tracking error (ETE):</li>
</ul>
<p><span class="math display">\[
\text{ETE}(\mathbf{w}) = \frac{1}{T}\big\|\mathbf{r}^b - \mathbf{X}\mathbf{w}\big\|_2^2
\]</span></p>
<ul>
<li>Downside risk (DR):</li>
</ul>
<p><span class="math display">\[
\text{DR}(\mathbf{w}) = \frac{1}{T}\big\|(\mathbf{r}^b-\mathbf{X}\mathbf{w})^+\big\|_2^2
\]</span></p>
<ul>
<li>Huber empirical tracking error (HETE):</li>
</ul>
<p><span class="math display">\[
\text{HETE}(\mathbf{w}) = \frac{1}{T}\mathbf{1}^\top\boldsymbol{\phi}\left(\mathbf{r}^b - \mathbf{X}\mathbf{w}\right)
\]</span></p>
<ul>
<li>Huber downside risk (HDR):</li>
</ul>
<p><span class="math display">\[
\text{HDR}(\mathbf{w}) = \frac{1}{T}\mathbf{1}^\top\boldsymbol{\phi}\left((\mathbf{r}^b-\mathbf{X}\mathbf{w})^+\right)
\]</span> where <span class="math inline">\(\boldsymbol{\phi}(\mathbf{x}) = [\phi(x_1), \dots, \phi(x_T)]^\top\)</span> and <span class="math display">\[
\phi(x) = \begin{cases}
x^2 &amp;\quad |x| \leq M\\
M(2|x| - M) &amp;\quad |x| &gt; M,
\end{cases}
\]</span> with <span class="math inline">\(M&gt;0\)</span> being the Huber parameter.</p>
<p>Regardless of the selected tracking error measure, this problem can be solved via Majorization-Minimization (MM) <span class="citation">[2]</span> with an iterative closed-form update algorithm (with iterations denoted by <span class="math inline">\(k\)</span>). It can be shown that all of the above variations boil down to the iterative optimization of the following convex problem: <span class="math display">\[
\begin{array}{ll}
\underset{\mathbf{w}}{\text{minimize}} &amp; \mathbf{w}^\top\mathbf{w} + {\mathbf{q}^{(k)}}^\top\mathbf{w}\\
\textsf{subject to} &amp; \mathbf{w}\in\mathcal{W}_{u},
\end{array} \qquad (3)
\]</span> where <span class="math display">\[
\mathcal{W}_{u} = \big\{\mathbf{w} \big| \mathbf{w}^\top\mathbf{1} = 1, \mathbf{0}\leq\mathbf{w}\leq u\mathbf{1}\big\},
\]</span> and <span class="math inline">\(\mathbf{q}^{(k)}\in\mathbb{R}^N\)</span>.</p>
<p>What differentiates the various tracking errors is the exact form of <span class="math inline">\(\mathbf{q}^{(k)}\)</span> that we need to compute at each iteration <span class="math inline">\(k\)</span> of the algorithm: <span class="math display">\[
\begin{aligned}
  \mathbf{q}_{\text{ETE}}^{(k)} &amp; = \frac{1}{\lambda_{\text{max}}^{(\mathbf{L}_1)}}(2(\mathbf{L}_1 - \lambda_{\text{max}}^{(\mathbf{L}_1)}\mathbf{I})\mathbf{w}^{(k)} + \lambda{\mathbf{d}_{p,u}^{(k)}} -\frac{2}{T}\mathbf{X}^\top\mathbf{r}^b),\\
  \mathbf{q}_{\text{DR}}^{(k)} &amp; = \frac{1}{\lambda_{\text{max}}^{(\mathbf{L}_1)}} (\frac{2}{T} 2(\mathbf{L}_1 - \lambda_{\text{max}}^{(\mathbf{L}_1)}\mathbf{I})\mathbf{w}^{(k)} + \lambda\mathbf{d}_{p,u}^{(k)} + \frac{2}{T}\mathbf{X}^\top(\mathbf{y}^{(k)} - \mathbf{r}^b)),\\
  \mathbf{q}_{\text{HETE}}^{(k)} &amp; = \frac{1}{\lambda_{\text{max}}^{(\mathbf{L}_2)}}(2(\mathbf{L}_2 - \lambda_{\text{max}}^{(\mathbf{L}_2)}\mathbf{I})\mathbf{w}^{(k)} + \lambda{\mathbf{d}_{p,u}^{(k)}} -\frac{2}{T}\mathbf{X}^\top\text{Diag}(\mathbf{a}^{(k)})\mathbf{r}^b),\\ 
  \mathbf{q}_{\text{HDR}}^{(k)} &amp; = \frac{1}{\lambda_{\text{max}}^{(\mathbf{L}_3)}}(2(\mathbf{L}_3 - \lambda_{\text{max}}^{(\mathbf{L}_3)}\mathbf{I})\mathbf{w}^{(k)} + \lambda{\mathbf{d}_{p,u}^{(k)}} +\frac{2}{T}\mathbf{X}^\top\text{Diag}(\mathbf{b}^{(k)})(\mathbf{c}^{(k)} - \mathbf{r}^b)),
\end{aligned}
\]</span> where <span class="math inline">\(\lambda_{\text{max}}^{(\mathbf{A})}\)</span> denotes the maximum eigenvalue of a matrix <span class="math inline">\(\mathbf{A}\)</span>, <span class="math inline">\(\mathbf{I}\)</span> denotes the identity matrix, <span class="math inline">\(\text{Diag}(\mathbf{x})\)</span> is a diagonal matrix with the vector <span class="math inline">\(\mathbf{x}\)</span> at its principal diagonal, and<br />
<span class="math display">\[
\begin{aligned}
  \mathbf{d}_{p,u}^{(k)} &amp; = \left[d_{p,u}(w_1^{(k)}),\dots,d_{p,u}(w_N^{(k)})\right]^\top,\\
    d_{p,u}(w^{(k)}) &amp; = \frac{1}{\log(1 + u/p)(p+w^{(k)})},\\
    \mathbf{y}^{(k)} &amp; = -(\mathbf{X}\mathbf{w}^{(k)} - \mathbf{r}^b)^+,\\
    \mathbf{a}^{(k)} &amp; = [a([\mathbf{r}^b - \mathbf{X}\mathbf{w}^{(k)}]_1),\dots,a([\mathbf{r}^b - \mathbf{X}\mathbf{w}^{(k)}]_T)]^\top,\\
    a(x) &amp; = \begin{cases} 1 &amp;\quad |x|\leq M\\
    \frac{M}{|x|} &amp;\quad |x| &gt; M,\end{cases}\\
    \mathbf{b}^{(k)} &amp; = [b([\mathbf{r}^b - \mathbf{X}\mathbf{w}^{(k)}]_1),\dots,b([\mathbf{r}^b - \mathbf{X}\mathbf{w}^{(k)}]_T)]^\top,\\
    b(x) &amp; = \begin{cases} \frac{M}{M - 2x} &amp;\quad x &lt; 0\\
    1 &amp;\quad0\leq x\leq M\\
    \frac{M}{x} &amp;\quad x &gt; M,\end{cases}\\
    \mathbf{c}^{(k)} &amp; = [c([\mathbf{r}^b - \mathbf{X}\mathbf{w}^{(k)}]_1),\dots,c([\mathbf{r}^b - \mathbf{X}\mathbf{w}^{(k)}]_T)]^\top,\\
    c(x) &amp; = \begin{cases} x &amp;\quad x &lt; 0\\
    0 &amp;\quad x \geq 0,\end{cases}\\
    \mathbf{L}_1 &amp; = \frac{1}{T}\mathbf{X}^\top\mathbf{X},\\
    \mathbf{L}_2 &amp; = \frac{1}{T}\mathbf{X}^\top\text{Diag}(\mathbf{a}^{(k)})\mathbf{X},\\
    \mathbf{L}_3 &amp; = \frac{1}{T}\mathbf{X}^\top\text{Diag}(\mathbf{b}^{(k)})\mathbf{X}.
\end{aligned}
\]</span></p>
<p>The following propositions provide a waterfilling structured solution of the above optimization problem, considering two special cases, namely, <span class="math inline">\(u=1\)</span> and <span class="math inline">\(u&lt;1\)</span>.</p>
<blockquote>
<p><strong>Proposition 1</strong> The optimal solution of the optimization problem (3) with <span class="math inline">\(u=1\)</span> is <span class="math display">\[\mathbf{w}^\star = \left(-\frac{1}{2}(\mu\mathbf{1} + \mathbf{q})\right)^+,\]</span><br />
with <span class="math display">\[\mu = -\frac{\sum_{i\in\mathcal{A}}q_i + 2}{\text{card}(\mathcal{A})},\]</span><br />
and <span class="math display">\[\mathcal{A} = \big\{j \big| \mu + q_j &lt; 0\big\},\]</span><br />
where <span class="math inline">\(\mathcal{A}\)</span> can be determined in <span class="math inline">\(O(\log(N))\)</span> steps. We refer to the iterative procedure of Proposition 1 as AS<span class="math inline">\(_{1}(\mathbf{q})\)</span> (Active-Set for <span class="math inline">\(u=1\)</span>).</p>
</blockquote>
<blockquote>
<p><strong>Proposition 2</strong> The optimal solution of the optimization problem (3) with <span class="math inline">\(u&lt;1\)</span> is <span class="math display">\[\mathbf{w}^\star = \left(\min\left(-\frac{1}{2}(\mu\mathbf{1} + \mathbf{q}),u\mathbf{1}\right)\right)^+,\]</span><br />
with <span class="math display">\[\mu = -\frac{\sum_{j\in\mathcal{B}_2}q_j + 2 - \text{card}(\mathcal{B}_1)2u}{\text{card}(\mathcal{B}_2)},\]</span><br />
and <span class="math display">\[\begin{aligned}
\mathcal{B}_1 &amp;= \big\{j \big| \mu + q_j \leq -2u\big\},\\
\mathcal{B}_2 &amp;= \big\{j \big| -2u &lt; \mu + q_j &lt; 0\big\},
\end{aligned}\]</span> where <span class="math inline">\(\mathcal{B}_1\)</span> and <span class="math inline">\(\mathcal{B}_2\)</span> can be determined in <span class="math inline">\(O(N\log(N))\)</span> steps. We refer to the iterative procedure of Proposition 2 as AS<span class="math inline">\(_u(\mathbf{q})\)</span> (Active-Set for general <span class="math inline">\(u&lt;1\)</span>).</p>
</blockquote>
<p>The iterative closed-form update algorithm is (where AS<span class="math inline">\(_{1|u}(\mathbf{q})\)</span> means AS<span class="math inline">\(_1(\mathbf{q})\)</span> or AS<span class="math inline">\(_u(\mathbf{q})\)</span>):</p>
<blockquote>
<p><strong>Algorithm 1</strong><br />
1. Set <span class="math inline">\(k=0\)</span> and choose an initial point <span class="math inline">\(\mathbf{w}^{(0)}\)</span><br />
2. Compute <span class="math inline">\(\mathbf{q}\)</span> according to the selected tracking error<br />
3. Find the optimal solution <span class="math inline">\(\mathbf{w}^\star\)</span> with AS<span class="math inline">\(_{1|u}(\mathbf{q})\)</span> and set it equal to <span class="math inline">\(\mathbf{w}^{(k+1)}\)</span> <br /> 4. <span class="math inline">\(k \gets k+1\)</span><br />
5. Repeat steps 2-4 until convergence<br />
6. Return <span class="math inline">\(\mathbf{w}^{(k)}\)</span></p>
</blockquote>
<p>The initial point of the algorithm <span class="math inline">\(\mathbf{w}^{(0)}\)</span> is set by default to <span class="math inline">\(1/N\)</span>, unless the user specifies otherwise.</p>
<p>Finally, note that the approximate problem is controlled by the parameter <span class="math inline">\(p\)</span>, and in particular, as <span class="math inline">\(p\rightarrow0\)</span> we get <span class="math inline">\(\rho_{p,u}\rightarrow\ell_0\)</span>. However, by setting small values to <span class="math inline">\(p\)</span>, it is likely that the algorithm will get stuck to a local minimum. To solve this issue we start with large values for <span class="math inline">\(p\)</span>, i.e., a “loose” approximation, and solve the corresponding optimization problem. Then, we sequentially decrease <span class="math inline">\(p\)</span>, i.e., we “tighten” the approximation, and solve the problem again using the previous solution as an initial point. In practice we are interested only in the last, “tightest” problem. For each problem that is solved (i.e., for fixed <span class="math inline">\(p\)</span>) we utilize an acceleration scheme that increases the convergence speed of the MM algorithm. For details, please refer to <span class="citation">[3]</span>.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<p>   </p>
<div id="refs" class="references">
<div id="ref-BenFengPal2018">
<p>[1] K. Benidis, Y. Feng, and D. P. Palomar, “Sparse portfolios for high-dimensional financial index tracking,” <em>IEEE Transactions on Signal Processing</em>, vol. 66, no. 1, pp. 155–170, Jan. 2018.</p>
</div>
<div id="ref-SunBabPal2018">
<p>[2] Y. Sun, P. Babu, and D. P. Palomar, “Majorization-minimization algorithms in signal processing, communications, and machine learning,” <em>IEEE Transactions on Signal Processing</em>, vol. 65, no. 3, pp. 794–816, Feb. 2017.</p>
</div>
<div id="ref-Varadhan2008">
<p>[3] R. Varadhan and C. Roland, “Simple and globally convergent methods for accelerating the convergence of any em algorithm,” <em>Scandinavian Journal of Statistics</em>, vol. 35, no. 2, pp. 335–353, 2008.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
